# SQL - Написание запросов к базе данных авиаперевозок
Запросы к БД "Авиаперевозки"

# Задачи работы с демонстрационной БД "Авиаперевозки"
1. Вывести названия самолетов, которые имеют менее 50 посадочных мест.
2. Вывести процентное изменение ежемесячной суммы бронирования билетов, округленной до сотых.
3. Вывести названия самолетов, не имеющих бизнес-класс. Решение должно быть через функцию array_agg.
4. Найти процентное соотношение перелетов по маршрутам от общего количества перелетов.
В результате должны быть представлены названия аэропортов и процентное отношение. Решение должно быть через оконную функцию.
5. Вывести количество пассажиров по каждому коду сотового оператора, если учесть, что код оператора - это три символа после +7
6. Классифицировать финансовые обороты (сумма стоимости перелетов) по маршрутам:
- До 50 млн - low
- От 50 млн включительно до 150 млн - middle
- От 150 млн включительно - high
В результате необходимо представить количество маршрутов в каждом полученном классе.
7. Вычислить медиану стоимости перелетов, медиану размера бронирования и отношение медианы бронирования к медиане стоимости перелетов, округленной до сотых.
8. Найти значение минимальной стоимости полета 1 км для пассажиров. То есть нужно найти расстояние между аэропортами и с учетом стоимости перелетов получить искомый результат.
-  Для поиска расстояния между двумя точками на поверхности Земли используется модуль earthdistance.
-  Для работы модуля earthdistance необходимо предварительно установить модуль cube.
-  Установка модулей происходит через команду: create extension название_модуля.

# Содержание файлов
SQL_Авиаперевозки.sql - запросы

bookings.pdf - описание БД
